"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[80],{80:(e,a,t)=>{t.r(a),t.d(a,{default:()=>m});var s=t(540),r=t(343),c=t(306),l=t(976),n=t(699);const m=function(){const e=(0,s.useRef)(null),a=(0,s.useRef)(null),t=(0,s.useRef)(null),m=(0,s.useContext)(r.A),u=(0,s.useContext)(c.A),[i,o]=(0,s.useState)({fieldValue:"",chatMessages:[]});return(0,s.useEffect)((()=>{m.isChatOpen&&(a.current.focus(),u({type:"clearUnreadChatCount"}))}),[m.isChatOpen]),(0,s.useEffect)((()=>(e.current=(0,n.Ay)("http://localhost:8080"),e.current.on("chatFromServer",(e=>{const a=i.chatMessages;a.push(e),o({chatMessages:[...a],fieldValue:""})})),()=>e.current.disconnect())),[]),(0,s.useEffect)((()=>{t.current.scrollTop=t.current.scrollHeight,i.chatMessages.length&&!m.isChatOpen&&u({type:"incrementUnreadChatCount"})}),[i.chatMessages]),s.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(m.isChatOpen?"chat-wrapper--is-visible":"")},s.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",s.createElement("span",{onClick:()=>u({type:"closeChat"}),className:"chat-title-bar-close"},s.createElement("i",{className:"fas fa-times-circle"}))),s.createElement("div",{id:"chat",className:"chat-log",ref:t},i.chatMessages.map(((e,a)=>e.username==m.user.username?s.createElement("div",{key:a,className:"chat-self"},s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},e.message)),s.createElement("img",{className:"chat-avatar avatar-tiny",src:e.avatar})):s.createElement("div",{key:a,className:"chat-other"},s.createElement(l.N_,{to:`/profile/${e.username}`},s.createElement("img",{className:"avatar-tiny",src:e.avatar})),s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},s.createElement(l.N_,{to:`/profile/${e.username}`},s.createElement("strong",null,e.username,": ")),e.message)))))),s.createElement("form",{onSubmit:function(a){a.preventDefault(),e.current.emit("chatFromBrowser",{message:i.fieldValue,token:m.user.token});const t=i.chatMessages;t.push({message:i.fieldValue,username:m.user.username,avatar:m.user.avatar}),o({chatMessages:[...t],fieldValue:""})},id:"chatForm",className:"chat-form border-top"},s.createElement("input",{ref:a,value:i.fieldValue,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off",onChange:function(e){const a=e.target.value;o({...i,fieldValue:a})}})))}}}]);